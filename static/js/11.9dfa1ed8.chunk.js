(this["webpackJsonpreact-ant2"]=this["webpackJsonpreact-ant2"]||[]).push([[11],{534:function(t,e,a){"use strict";a.r(e),a.d(e,"default",(function(){return _}));var n=a(88),s=a(33),r=a.n(s),c=a(52),i=a(442),o=a(443),u=a(525),d=a(521),l=a(0),h=a.n(l),f=a(126),p=a(543),b=a(168),m=a(540),v=a(162),j=a(538),x=a(524),S=a(37),O=a(35),g=a(445),k=a.n(g),w=a(48),y=a(6);function Y(t){var e=[],a=36e5,n=Math.trunc(t/a);n>0&&(e.push(n+"h"),t-=n*a);var s=Math.trunc(t/6e4);s>0&&(e.push(s+"m"),t-=6e4*s);var r=Math.trunc(t/1e3);return r>0&&e.push(r+"s"),e.join(" ")}var _=function(t){Object(u.a)(a,t);var e=Object(d.a)(a);function a(){var t;Object(i.a)(this,a);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(t=e.call.apply(e,[this].concat(s))).state={columns:[{title:"Name",dataIndex:"name"},{title:"status",dataIndex:"status",width:"6em"},{title:"start time",dataIndex:"start_time",width:"11em"},{title:"end time",dataIndex:"end_time",width:"11em"},{title:"duration",dataIndex:"duration"},{title:"counts",dataIndex:"counts"}],rows:[],tableLoading:!0,selectSize:20,recordStart:0,recordsTttl:1,style:{paginationExt:{paddingTop:"0rem"}}},t}return Object(o.a)(a,[{key:"componentDidMount",value:function(){var t=Object(c.a)(r.a.mark((function t(){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.updateTable();case 2:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"setSelectSize",value:function(t){t?this.setState({selectSize:t.valueOf()}):this.setState({selectSize:10})}},{key:"setRecordStart",value:function(t){t?this.setState({recordStart:t.valueOf()}):this.setState({recordStart:0})}},{key:"appendRowsFake",value:function(t){var e,a=this,s=["total","seen","new","differ","delete","task error","export error"],r=0,c=0,i=[],o=Object(n.a)(t);try{var u=function(){var t=e.value;if(c>=a.state.recordStart){if(r<a.state.selectSize){var n=k()(t.end_time,"DD.MM.YYYY HH:mm:ss").valueOf()-k()(t.start_time,"DD.MM.YYYY HH:mm:ss").valueOf();t.duration=Y(n);var o="";s.forEach((function(e){o+="".concat(e,": ").concat(t["count_"+e.replace(" ","_")],"\n")})),t.counts="".concat(o,"last doc ID: ").concat(t.last_doc_id),i.push(t),r+=1}c+=1}c+=1};for(o.s();!(e=o.n()).done;)u()}catch(d){o.e(d)}finally{o.f()}return i}},{key:"appendRows",value:function(t){var e,a=["total","seen","new","differ","delete","task error","export error"],s=[],r=Object(n.a)(t);try{var c=function(){var t=e.value,n=k()(t.end_time,"DD.MM.YYYY HH:mm:ss").valueOf()-k()(t.start_time,"DD.MM.YYYY HH:mm:ss").valueOf();t.duration=Y(n);var r="";a.forEach((function(e){r+="".concat(e,": ").concat(t["count_"+e.replace(" ","_")],"\n")})),t.counts="".concat(r,"last doc ID: ").concat(t.last_doc_id),s.push(t)};for(r.s();!(e=r.n()).done;)c()}catch(i){r.e(i)}finally{r.f()}return s}},{key:"updateTable",value:function(){var t=Object(c.a)(r.a.mark((function t(){var e,a,n;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.setState({tableLoading:!0}),!w.b){t.next=7;break}return t.next=4,Object(S.b)("a=schedule?cmd=QueueInfo&start=".concat(this.state.recordStart,"&limit=").concat(this.state.selectSize),{status:200,data:O.e},600);case 4:e=t.sent,t.next=10;break;case 7:return t.next=9,Object(S.a)("a=schedule?cmd=QueueInfo&start=".concat(this.state.recordStart,"&limit=").concat(this.state.selectSize));case 9:e=t.sent;case 10:a=[],n=1,e&&("ok"===e.data.status?a=w.b?this.appendRowsFake(e.data.tasks):this.appendRows(e.data.tasks):f.b.error(e.data.message)),a.length>1&&(n=a.length),this.setState({rows:a,recordsTttl:n,tableLoading:!1});case 15:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"render",value:function(){var t=this;return Object(y.jsx)(y.Fragment,{children:Object(y.jsxs)(p.a,{title:"Tasks journal",children:[Object(y.jsx)("div",{className:"pagination-ext",style:{position:"absolute",right:0,paddingTop:".8em",paddingRight:"2em",zIndex:1},children:Object(y.jsxs)(b.b,{children:[Object(y.jsx)("span",{children:"Record start:"}),Object(y.jsx)(m.a,{id:"recordStart",min:0,defaultValue:this.state.recordStart,onChange:function(e){return t.setRecordStart(e)},onPressEnter:function(){return t.updateTable()},disabled:this.state.tableLoading}),Object(y.jsx)("span",{children:"Records limit:"}),Object(y.jsx)(m.a,{id:"selectSize",min:1,defaultValue:this.state.selectSize,onChange:function(e){return t.setSelectSize(e)},onPressEnter:function(){return t.updateTable()},disabled:this.state.tableLoading}),Object(y.jsx)(v.a,{id:"updateTable",icon:Object(y.jsx)(x.a,{}),onClick:function(){return t.updateTable()},disabled:this.state.tableLoading})]})}),Object(y.jsx)(j.a,{rowKey:"id",columns:this.state.columns,dataSource:this.state.rows,size:"small",loading:this.state.tableLoading,pagination:{defaultCurrent:1,position:["topLeft","bottomLeft"],showLessItems:!1,total:this.state.recordsTttl},bordered:!0,sticky:!0,style:{whiteSpace:"pre"},scroll:{x:"80em"}})]})})}}]),a}(h.a.Component)}}]);
//# sourceMappingURL=11.9dfa1ed8.chunk.js.map